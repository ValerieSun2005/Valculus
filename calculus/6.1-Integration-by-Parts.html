<!DOCTYPE html>
<html>
  <head>
    <title>6.1: Integration by Parts</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="ie-edge" http-equiv="X-UA-Compatible">
    <meta content="Valerie" name="author">
    <meta charset="UTF-8">
    <link href="/Valculus/css/hamburger-menu.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="/Valculus/css/layout.css" rel="stylesheet">
    <link href="/Valculus/css/layout-print.css" media="print" rel="stylesheet">
    <link href="/Valculus/images/favicon.png" rel="icon">
    <script crossorigin="anonymous" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <link href="/Valculus/css/notes-style.css" rel="stylesheet">
<link href="/Valculus/css/notes-style-print.css" media="print" rel="stylesheet">
  </head>
  <body>
    <a href="/Valculus/index.html">
    <img src="/Valculus/images/logo.png" class="logo-image" alt="">
    </a>
<h1>6.1: Integration by Parts</h1>
<main>
<div class="pdf-panel">
    <div class="pdf-panel-left">
      <ul>
        <li>
          <button>
            <a class="link-deactivate" rel="noopener">Section <i class="fa fa-external-link"></i></a>
          </button>
        </li>
        <li>
          <button>
            <a href="6.1-Integration-by-Parts-exercises.html">Exercises <i class="fa fa-external-link"></i></a>
          </button>
        </li>
        <li>
          <button>
            <a href="6.1-Integration-by-Parts-exercises-solutions.html">Exercise Solutions <i class="fa fa-external-link"></i></a>
          </button>
        </li>
      </ul>
    </div>
  </div>
<hr id="mainBodyBegin">
<!--[[[crefId.Integration-by-Parts]]]--> 
<p>
    We've seen integrals that can be evaluated by a substitution.
    For example, we evaluate \(\int \cos 2x \di x\) by substituting \(u = 2x.\)
    In this section we build on this knowledge 
    by exploring how to reexpress integrals as simpler expressions. 
    Because we use the Product Rule to differentiate a product of functions, 
    let's reverse this process by learning to integrate a product of functions.
</p>
<p>
    Let \(u\) and \(v\) be two differentiable functions of \(x.\)
    By the Product Rule, the derivative of the product \(uv\) is 
    \[(uv)' = u' v + u v' \pd \]
    Integrating both sides gives 
    \[
    \ba 
    \int (uv)' \di x &= \int u' v \di x + \int u v' \di x \nl
    uv &= \int u' v \di x + \int u v' \di x \nl
    \int u v' \di x &= uv - \int u' v \di x  \pd 
    \ea
    \]
    We condense the terms \(u' \di x\) and \(v' \di x\) as \(\dd u\) and \(\dd v,\) respectively.
    Thus, we have   
    \begin{equation}
    \int u \di v = uv - \int v \di u \label{eq:ibp} \pd
    \end{equation}
    In words, \(\eqref{eq:ibp}\) allows us to reexpress an integral \(\int u \di v\)
    by choosing a term \(u\) to differentiate and an expression \(\dd v\) to integrate.
    The resulting integral, \(\int v \di u,\) is hopefully easier to evaluate.
    We call this procedure <span class="emph">Integration by Parts</span>.
</p>
<p>
    <span class="text-tip">TIP</span>
    Try to let \(u\) be a function whose derivative is simpler than \(u.\)
    Hence, when we select \(u\) we often prioritize logarithmic functions or inverse trigonometric functions.
    Of course, <i>exceptions apply</i>; no set of rules can replace trial and error.
</p>

<!-- table for ibp formula-->
<div class="box-title"> INTEGRATION BY PARTS FORMULA </div>
<div class="box">
    If \(u\) and \(v\) are differentiable functions of \(x,\) then 
    \begin{equation}
    \int u \di v = uv - \int v \di u \eqlabel{eq:ibp} \pd
    \end{equation}
</div>

<div class="example-title" id="ex-e"> EXAMPLE 1 </div>
<div class="example">
    <div class="example-problem">  
        \[\int x e^x \di x\]
    </div>
</div>
<button onclick="toggle1()" class="solution-button"> </button>
<div id="solution1" class="solution">
    Performing a substitution fails to evaluate the integral, so we instead attempt Integration by Parts.
    The factor \(x\) is simpler when differentiated, so let's choose \(u = x\)
    and \(\dd v = e^x \di x.\)
    Differentiating and integrating these respective functions, we attain
    \[\dd u = 1 \di x \and v = e^x \pd\]
    Therefore, by \(\eqref{eq:ibp}\) we see
    \[
    \ba 
    \int xe^x \di x &= x \par{e^x} - \int e^x (1) \di x \nl
    &= xe^x - \int e^x \di x \nl 
    &= \boxed{xe^x - e^x + C} 
    \ea
    \]
</div>

<p>
    <span class="text-remark">REMARK</span>
    In <a href="/ValCalc/ValCalc/calculus/6.1-Integration-by-Parts.html#ex-e">Example 1</a>
    our choices of \(u\) and \(\dd v\) succeeded 
    because they yielded the simpler integral \(\int e^x \di x.\)
    But flipping our choices—that is, selecting \(u = e^x\) and \(\dd v = x \di x\)
    (from which \(\dd u = e^x \di x\) and <nobr>\(v = \tfrac{1}{2} x^2\))</nobr>—would instead give 
    \[\int x e^x \di x = \tfrac{1}{2} x^2 e^x - \int \tfrac{1}{2} x^2 e^x \di x \pd\]
    While this equation is true,
    <i>it does not help us</i> since
    the integral \(\int \frac{1}{2} x^2 e^x \di x\) is more complicated to evaluate. 
</p>
<p>
    For this reason, <span class="warning">it is insufficient to simply memorize</span> \(\eqref{eq:ibp};\)
    you must strategically choose \(u\) and \(\dd v.\)
    Integration is a skill; the choices of \(u\) and \(\dd v\) are not always obvious. 
    Hence, <i>keep practicing</i>.
</p>

<div class="example-title"> EXAMPLE 2 </div>
<div class="example">
    <div class="example-problem">  
        \[\int x^3 \ln x \di x\]
    </div>
</div>
<button onclick="toggle2()" class="solution-button"> </button>
<div id="solution2" class="solution">
    The integrand is a product of \(x^3\) and \(\ln x.\)
    Let's choose \(u = \ln x\)
    since it become simpler when differentiated.
    Therefore, we perform Integration by Parts with 
    \[
    \baat{2} 
    u &= \ln x \lspace &\dd v &= x^3 \di x \nl 
    \dd u &= \frac{1}{x} \di x \lspace &v &= \frac{x^4}{4} \pd
    \eaat
    \]
    Using \(\eqref{eq:ibp},\) we have
    \[
    \ba 
    \int x^3 \ln x \di x &= \par{\ln x} \par{\frac{x^4}{4}} - \int \frac{x^4}{4} \par{\frac{1}{x}} \di x \nl
    &= \frac{x^4}{4} \ln x - \int \frac{x^3}{4} \di x \nl
    &= \boxed{\frac{x^4}{4} \ln x - \frac{x^4}{16} + C}
    \ea 
    \]
</div>

<div class="example-title" id="ex-ln-ibp"> EXAMPLE 3 </div>
<div class="example">
    <div class="example-problem">  
        \[\int \ln x \di x\]
    </div>
</div>
<button onclick="toggle3()" class="solution-button"> </button>
<div id="solution3" class="solution">
    The integrand appears to only be one factor.
    But we can perform Integration by Parts with 
    \[
    \baat{2} 
    u &= \ln x \lspace &\dd v &= \dd x \nl 
    \dd u &= \frac{1}{x} \di x \lspace &v &= x \pd
    \eaat
    \]
    By \(\eqref{eq:ibp},\) we see 
    \[
    \ba 
    \int \ln x \di x 
    &= \par{\ln x} (x) - \int x \par{\frac{1}{x}} \di x \nl 
    &= x \ln x- \int \dd x \nl
    &= \boxed{x \ln x - x + C}
    \ea
    \]
</div>

<aside class="box-recall">
    We write \(\int \dd x\) to mean \(\int 1 \di x.\)
</aside>

<div class="example-title" id="ex-f"> EXAMPLE 4 </div>
<div class="example">
    <div class="example-problem">
        A function \(f\) satisfies \(f(0) = 0\), \(f(4) = 3,\) and \(f'(4) = 2.\) 
        Calculate 
        \[\int_0^4 x f''(x) \di x \pd\]
    </div>
</div>
<button onclick="toggle4()" class="solution-button">  </button>
<div id="solution4" class="solution">
    Using Integration by Parts, we reexpress the integral by choosing 
    \[
    \baat{2} 
    u &= x \lspace &\dd v &= f''(x) \di x \nl 
    \dd u &= \dd x \lspace &v &= f'(x) \pd
    \eaat
    \]
    By \(\eqref{eq:ibp},\) we see
    \[
    \ba
    \int_0^4 x f''(x) \di x &= x f'(x) \intEval_0^4 - \int_0^4 f'(x) \di x \nl
    &= [4 f'(4) - 0] - \parbr{f(4) - f(0)} \nl 
    &= 4(2) - (3 - 0) = \boxed 5
    \ea
    \]
</div>

<p>
    Because Integration by Parts enables us to reexpress an integral, 
    we are <span class="warning">not</span> performing a substitution.
    The quantities \(u\) and \(\dd v\) are simply placeholders; 
    they do not initiate a variable change. 
    So in <a href="#ex-f">Example 4</a>, we did not change
    the bounds of the integral. 
    Just as we use a combination of differentiation rules, 
    Integration by Parts can be paired with other integration techniques—most notably,
    the Substitution Rule, as shown by the following example.
</p>

<div class="example-title"> EXAMPLE 5 </div>
<div class="example">
    <div class="example-problem">  
        Calculate the area of the region 
        bounded in the first quadrant by the curve \(y = \asin x.\)
    </div>
</div>
<button onclick="toggle5()" class="solution-button"> </button>
<div id="solution5" class="solution">
    <p>
        The graph of \(y = \asin x\) is positive in the first quadrant, 
        so the area is given by the definite integral 
        \[\int_0^1 \asin x \di x \pd\]
        <a href="#ibp-arcsin-area">Figure 1</a> shows this bounded region \(R.\)
    </p>
    <figure class="ibp-arcsin-area" id="ibp-arcsin-area">
        <img src="../images/sectionImages/ibp-arcsin-area.jpg" alt="Figure 1">
    </figure>
    <style>
        .ibp-arcsin-area::before{
            content:'FIGURE 1';
        }
    </style>
    <p>
        <span class="label-emph">Antidifferentiation</span>
        To find \(\int \asin x \di x,\) let's conduct Integration by Parts with 
        \[
        \baat{2} 
        u &= \asin x \lspace &\dd v &= \dd x \nl 
        \dd u &= \frac{1}{\sqrt{1 - x^2}} \di x \lspace &v &= x \pd
        \eaat
        \]
        So \(\eqref{eq:ibp}\) gives 
        \[\int \asin x \di x = x \asin x - \int \frac{x}{\sqrt{1 - x^2}} \di x \pd\]
        We evaluate \(\int x/\sqrt{1 - x^2} \di x\) by substituting
        \(w = 1 - x^2.\) Then \(\dd w = -2x \di x\) and so the integral becomes
        \[-\int \frac{1}{2\sqrt w} \di w = -\tfrac{1}{2} \par{2 \sqrt w} + C = -\sqrt{1 - x^2} + C \pd\]   
        So we have
        \[
        \ba
        \int \asin x \di x &= x \asin x - \par{-\sqrt{1 - x^2}} + C \nl
        &= x \asin x + \sqrt{1 - x^2} + C \pd 
        \ea
        \]
    </p>
    <p>
        <span class="label-emph">Area</span>
        By the Fundamental Theorem of Calculus, 
        the area is 
        \[
        \ba
        \int_0^1 \asin x \di x &= \par{x \asin x + \sqrt{1 - x^2}} \intEval_0^1 \nl 
        &= \par{\asin 1 + 0} - \par{\sqrt 1} \nl 
        &= \boxed{\frac{\pi}{2} - 1}
        \ea
        \]
    </p>
</div>

<div class="example-title"> EXAMPLE 6 </div>
<div class="example">
    <div class="example-problem">  
        \[\int x^2 \cos x \di x\]
    </div>
</div>
<button onclick="toggle6()" class="solution-button"> </button>
<div id="solution6" class="solution">
    Since \(x^2\) becomes simpler when differentiated, 
    we choose it to be \(u.\)
    Performing Integration by Parts with 
    \[
    \baat{2} 
    u &= x^2 \lspace &\dd v &= \cos x \di x \nl 
    \dd u &= 2x \di x \lspace &v &= \sin x \cma
    \eaat
    \]
    we follow \(\eqref{eq:ibp}\) to get
    \[
    \int x^2 \cos x \di x = x^2 \sin x - \int 2x \sin x \di x \pd
    \]
    The resulting integral, \(\int 2x \sin x \di x,\)
    is simpler than the starting integral. 
    To evaluate it, we perform Integration by Parts again with 
    \[
    \baat{2} 
    u &= 2x \lspace &\dd v &= \sin x \di x \nl 
    \dd u &= 2 \di x \lspace &v &= -\cos x \pd
    \eaat
    \]
    Accordingly, we see
    \[
    \ba 
    \int x^2 \cos x \di x &= x^2 \sin x - \par{-2x \cos x - \int 2 (-\cos x) \di x} \nl 
    &= x^2 \sin x + 2x \cos x - 2 \int \cos x \di x \nl
    &= \boxed{x^2 \sin x + 2x \cos x - 2 \sin x + C}
    \ea 
    \]
</div>

<div class="example-title" id="ex-e-sin"> EXAMPLE 7 </div>
<div class="example">
    <div class="example-problem">  
        \[\int e^x \sin x \di x\]
    </div>
</div>
<button onclick="toggle7()" class="solution-button"> </button>
<div id="solution7" class="solution">
    Neither \(e^x\) nor \(\sin x\) becomes simpler 
    when differentiated.
    Nevertheless, let's try Integration by Parts with 
    \[
    \baat{2} 
    u &= e^x \lspace &\dd v &= \sin x \di x \nl 
    \dd u &= e^x \di x \lspace &v &= - \cos x \pd
    \eaat
    \]
    Then \(\eqref{eq:ibp}\) gives 
    \[
    \ba 
    \int e^x \sin x \di x
    &= \par{e^x} \par{-\cos x} - \int \par{-\cos x} \par{e^x} \di x \nl 
    &= - e^x \cos x + \int e^x \cos x \di x \pd
    \ea 
    \]
    Now we employ a clever trick: 
    We reexpress \(\int e^x \cos x \di x\) 
    in terms of the left-hand integral, \(\int e^x \sin x \di x,\)
    and then combine terms. 
    Doing so, we use Integration by Parts again with 
    \[
    \baat{2} 
    u &= e^x \lspace &\dd v &= \cos x \di x \nl 
    \dd u &= e^x \di x \lspace &v &= \sin x \pd
    \eaat
    \]
    So we see 
    \[
    \ba 
    \int e^x \sin x \di x &= 
    - e^x \cos x + \par{e^x \sin x - \int (\sin x) e^x \di x} \nl 
    &= -e^x \cos x + e^x \sin x - \int e^x \sin x \di x \pd
    \ea
    \]
    Adding \(\int e^x \sin x \di x\) to both sides and including the integration constant \(C,\) we get 
    \[
    \ba 
    2\int e^x \sin x \di x &= -e^x \cos x + e^x \sin x + C \nl 
    \implies \int e^x \sin x \di x &= \tfrac{1}{2} \par{-e^x \cos x + e^x \sin x} + C \nl
    &= \boxed{\tfrac{1}{2} e^x \sin x - \tfrac{1}{2} e^x \cos x + C}
    \ea 
    \]
</div>

<div class="section-summary">
    <p class="p-no-indent">
        <span class="emph">Integration by Parts</span> permits us to reexpress the integral of a product 
        into an easier form. 
        We break an integral into two parts, one we differentiate and the other we integrate. 
        If \(u\) and \(v\) are differentiable functions of \(x,\) then 
        \begin{equation}
        \int u \di v = uv - \int v \di u \eqlabel{eq:ibp} \pd
        \end{equation}
        It is 
        <span class="warning">not</span> 
        enough to simply memorize the formula. 
        Integration is a skill that you must practice—you 
        must know what expressions to assign \(u\) and \(\dd v.\)
        In general, choose \(u\) to be the function whose derivative is simpler.
    </p>
</div>

</main>
</main>
<!-- <footer>
    <div class="footer-body">
        <div class="footer-nav-column">
            <h3>Navigation</h3>
            <ul>
                <li>
                    <a href="/Valculus/index.html">Home</a> 
                </li>
                <li>
                    <a href="/Valculus/about.html">About</a> 
                </li>
                <li>
                    <a href="/Valculus/faq.html">FAQ</a> 
                </li>
                <li>
                    <a href="/Valculus/contact.html">Contact</a> 
                </li>
            </ul>
        </div>
        <div class="footer-nav-column">
            <h3>Extra Help</h3>
            <ul>
                <li>
                    <a href="/Valculus/test-taking-tips.html">Test-Taking Tips</a> 
                </li>
                <li>
                    <a href="/Valculus/additional-resources.html">Additional Resources</a> 
                </li>
            </ul>
        </div>
        <div class="footer-nav-column">
            <h3>Prerequisites</h3>
            <ul>
                <li>
                    <a href="/Valculus/index.html"> Section Notes </a> 
                </li>
                <li>
                    <a href="/Valculus/faq.html"> AP Calculus  </a> 
                </li>
                <li>
                    <a href="/Valculus/faq.html"> Before Taking Calculus  </a> 
                </li>
                <li>
                    <a href="/Valculus/faq.html"> Practice Tests  </a> 
                </li>
            </ul>
        </div>
        <div class="footer-nav-column">
            <h3>Technical</h3>
            <ul>
                <li>
                    <a href="/Valculus/terms-of-use.html"> Terms of Use </a> 
                </li>
                <li>
                    <a href="/Valculus/index.html">Report a Problem</a> 
                </li>

                <li>
                    <a href="/Valculus/faq.html">Privacy Policy</a> 
                </li>
                <li>
                    <a href="/Valculus/contact.html">Donate</a> 
                </li>
            </ul>
        </div>
    </div>
</footer> -->

    <script src="/Valculus/js/mathjax-config.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script async="async" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    <script async="async" id="AMSmath" src="TeX/AMSmath.js"></script>
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="/Valculus/js/toggle-solutions.js"></script>
</body>